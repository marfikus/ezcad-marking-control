
# EzCad Marking Control

Небольшая консольная утилита для помощи при работе на станке лазерной маркировки, а конкретно для взаимодействия с программой EzCad. Позволяет сократить количество нажатий клавиш, что несколько ускоряет рабочий процесс и делает его немного приятнее. В моём случае это возможность чтения книги с экрана компьютера, параллельно с выполнением работы на станке.

Вместо переключения окон нажатием Alt+Tab, можно, например, просто нажать клавишу "ё". Утилита сама переключит окна и выполнит необходимые операции в программе EzCad. По завершении необходимых действий со станком, нажатием клавиши "1" возвращаемся к своей книге, а станок продолжает работу.

Конфигурация утилиты выполняется в файле **ezcad_marking_control.ini**.  
Параметры файла конфигурации:  
`char_f1` - символ. Клавиша, на нажатие которой будет реагировать утилита (команда 1).  
`char_f2` - символ. Клавиша, на нажатие которой будет реагировать утилита (команда 2). На данный момент не используется.  
`char_esc` - символ. Клавиша, на нажатие которой будет реагировать утилита (команда 3).  
Далее идут различные параметры окна программы EzCad, значения которых определяются опытным путём.  
`operations_delay` - десятичная дробь. Время задержки между выполнением операций в секундах.  
`await_rotor_cycle_delay` - десятичная дробь, секунды.  
`await_rotor_timeout` - десятичная дробь, секунды.  
`rotor_position_diff` - десятичная дробь.  
`window_title` - строка. Заголовок или часть заголовка окна программы, за которой нужно наблюдать.  
`element_title` - строка. Текст элемента в дереве компонентов окна наблюдаемой программы. Относительно этого элемента можно определить нужное поле.  
`shift_from_element` - целое число. Сдвиг на количество элементов в дереве, относительно элемента с текстом из предыдущего параметра. Если значение положительное, то будет отсчитываться элемент следующий за ним. Если отрицательное, то перед ним.

`switch_windows` - целое число (1 или 0). Переключение между окнами. 1 - включено, 0 - выключено.  
`auto_start_burn` - целое число (1 или 0). Автоматический запуск очередной итерации станка. 1 - включено, 0 - выключено.  
`check_foreground_window_on_f1` - целое число (1 или 0). Проверка заголовка окна на переднем плане (в фокусе). Значение заголовка сверяется со списком допустимых вариантов, который определяется следующим параметром. 1 - включено, 0 - выключено.  
`valid_foreground_window_titles_on_f1` - список строк в кавычках, объединённых в квадратные скобки. Пример: `["ezcad_marking_control.exe", "SumatraPDF"]`. Содержит заголовки (или части заголовков) окон программ, на нажатие клавиш в которых будет реагировать утилита. Позволяет отсеять лишние окна и тем самым исключить ложные срабатывания.  
`check_foreground_window_on_esc` - целое число (1 или 0). Параметр аналогичный `check_foreground_window_on_f1`, но для другой команды алгоритма (возврат обратно в читалку, например). Значение сверяется со значением из следующего параметра. 1 - включено, 0 - выключено.  
`valid_foreground_window_title_on_esc` - строка. Заголовок или часть заголовка окна программы, из которой нужно вернуться обратно (например в читалку).  
`debug_print` - целое число (1 или 0). Вывод различной отладочной информации в консоль. 1 - включено, 0 - выключено.

Скачать exe-файл утилиты можно [здесь]()
